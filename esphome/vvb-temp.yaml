esphome:
  name: vvb-temp
  includes:
    - ingics_parser.h

esp32:
  board: esp32doit-devkit-v1
  framework:
    type: arduino

web_server:
  port: 80
  include_internal: true

logger:

api:

ota:
  - platform: esphome
    password: !secret api_password

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password
  ap:
    ssid: "Vvb-Temp Fallback Hotspot"
    password: !secret fallback_password_vvb

captive_portal:
bluetooth_proxy:
  active: true

esp32_ble_tracker:
  scan_parameters:
    active: true
  on_ble_advertise:
    - then:
        lambda: |-
          std::string mac = x.address_str();

          if (mac == "A0:6C:65:E2:1A:25") {
            if (auto temp = parse_ingics_temp(x)) id(fryser_temp).publish_state(*temp);
          }
          // else if (mac == "XX:XX:XX:XX:XX:XX") {
          //   if (auto temp = parse_ingics_temp(x)) id(another_sensor).publish_state(*temp);
          // }


one_wire:
  - platform: gpio
    pin: GPIO15
    #update_interval: 20s

sensor:
  - platform: dallas_temp
    address: 0x9AB9E1271E64FF28
    name: "VVB Top"
    update_interval: 15s

  - platform: dallas_temp
    address: 0x1A61595E1E64FF28
    name: "VVB Bottom"
    update_interval: 15s

  - platform: template
    id: fryser_temp
    name: "Ingics Fryser Temp"
    unit_of_measurement: "Â°C"
    device_class: temperature
    state_class: measurement
    accuracy_decimals: 1